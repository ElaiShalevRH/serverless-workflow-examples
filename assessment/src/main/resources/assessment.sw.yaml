specVersion: "0.8"
id: assessment
name: Assessment
annotations:
  - "workflow-type/assessment"
version: 0.0.1
start: AssessRepository
dataInputSchema: schema/input-schema.json
functions:
  - name: execute
    type: custom
    operation: "service:java:com.redhat.parodos.workflow.assessment.BasicAssessment::execute"
  - name: logOuput
    type: custom
    operation: "sysout:INFO"
  - name: preCheck
    operation: "specs/precheck.yaml#createResource_preCheck"
states:
  - name: AssessRepository
    type: operation
    # stateDataFilter:
    #   output: '{workflowOptions: .validatedResult}'
    actions:
      - name: executeAction
        functionRef:
          refName: execute
          arguments:
            repositoryUrl: ".repositoryUrl"
        actionDataFilter:
          toStateData: ".result"
      - name: preCheck
        functionRef:
          refName: preCheck
          arguments:
            # replace workflowdata with any other words, then the call will be received by the precheck.
            # but the result is unable to be fetched
            workflowdata: 
              result: .result
        actionDataFilter:
          results: "${ {preCheck: .workflowdata} }"
          toStateData: "${ .preCheck }"
      - name: printAction
        functionRef:
          refName: logOuput
          arguments:
            message: ".preCheck"
    end: true